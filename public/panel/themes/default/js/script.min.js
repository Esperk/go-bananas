function Form(a,b){var b=b||!0;this.form=a,b&&this.init()}function getRealWidth(a){var b=a.width();a.css("width","auto");var c=a.width();return a.css("width",b+"px"),c}$(function(){var a=new Form(document.getElementById("authentication"),!1),b=$(a.form),c=b.find(".field.error");c.length>0&&c.each(function(){var c=b.find('*[name="'+this.dataset.field+'"]'),d=c[0].parentNode,e=a.getAddon(d);e?(a.addInlineError(d,e,this.innerText),d.classList.add("required"),this.parentNode.removeChild(this)):this.style.display="block"})}),Form.prototype.init=function(){var a=this;$(this.form).submit(function(b,c){a.submit(b,c)})},Form.prototype.submit=function(a,b){if(!b){a.preventDefault();var c=this,d=$(this.form),e=d.attr("action")||location.pathname,f={};this.isValid()&&(d.find("input, select, textarea").not(":input[type=button], :input[type=submit], :input[type=reset]").each(function(){f[this.getAttribute("name")]=this.value}),$.ajax(e,{contentType:"application/json",type:"POST",data:JSON.stringify(f),dataType:"json"}).done(function(a){if(a.success===!0)$(c.form).trigger("submit",[!0]);else{var b=$.cookie("language");"undefined"!=typeof b&&$.getJSON("/panel/translations/"+b+"/package.json",function(b){c.parseErrors(b,a)})}}))}},Form.prototype.isValid=function(){for(var a=this.form.querySelectorAll("input[required]"),b=0,c=0,d=a.length;d>c;c++){var e=a[c],f=e.parentNode;""!==e.value||f.classList.contains(".required")?f.classList.remove("required"):(f.classList.add("required"),b++)}return 0===b?!0:!1},Form.prototype.parseErrors=function(a,b){for(var c in b.fields){var d=b.fields[c],e=this.form.querySelector('*[name="'+d.param+'"]'),f=e.parentNode,g=this.getAddon(f);if(g)this.addInlineError(f,g,a[b.translation].errors[d.msg]);else{var h=document.createElement("div"),i=document.createElement("span"),j=document.createTextNode(a[b.translation].errors[d.msg]);i.appendChild(j),h.appendChild(i),h.classList.add("field error"),this.form.insertBefore(h,this.form.firstChild),h.style.display="block"}f.classList.add("required")}},Form.prototype.getAddon=function(a){a instanceof jQuery&&(a=a[0]);for(var b=a.firstChild;1!==b.nodeType&&b.nextSibling;)b=b.nextSibling;return 1===b.nodeType&&"span"===b.tagName.toLowerCase()?b:!1},Form.prototype.addInlineError=function(a,b,c){var d=document.createElement("span"),e=document.createTextNode(c),f=!1,g=!1,c=$(d);d.appendChild(e),d.classList.add("error-message"),a.insertBefore(d,b),$(a).bind({mousedown:function(){f=!0},mouseup:function(){f=!1}}),$(b).bind({mouseenter:function(){f||(g=!0,c.stop().animate({width:getRealWidth(c)+"px"},200))},mouseover:function(){g||f||$(this).trigger("mouseenter")},mouseleave:function(){c.stop().animate({width:"0px"},200,function(){g=!1})}})},$(function(){$("form.validate").each(function(){new Form(this)})});